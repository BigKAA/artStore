# ==============================================================================
# ArtStore Environment Configuration Template
# ==============================================================================
# ВАЖНО: Этот файл содержит примеры конфигурации.
# Скопируйте в .env и настройте под ваше окружение.
#
# Security Warning: НЕ КОММИТЬТЕ .env файлы с реальными credentials!
#
# Использование:
#   cp .env.example .env
#   # Редактируйте .env и измените критические параметры
# ==============================================================================

# ==============================================================================
# ENVIRONMENT
# ==============================================================================
ENVIRONMENT=development  # development | staging | production

# ==============================================================================
# DATABASE (PostgreSQL - Async via asyncpg)
# ==============================================================================
DB_HOST=postgres  # Используйте "postgres" для Docker, "localhost" для внешнего доступа
DB_PORT=5432
DB_USERNAME=artstore
DB_PASSWORD=password  # ⚠️ ИЗМЕНИТЬ ДЛЯ PRODUCTION! Используйте strong random password (32+ chars)

# PostgreSQL Connection Pool
DB_POOL_SIZE=20  # Размер connection pool
DB_MAX_OVERFLOW=10  # Максимальное количество overflow connections

# PostgreSQL Auth Method
POSTGRES_AUTH_METHOD=md5  # md5 для production, trust для dev (НЕ безопасно!)

# ==============================================================================
# REDIS (Service Discovery & Caching - SYNC режим!)
# ==============================================================================
# ВАЖНО: Redis используется в SYNC режиме (redis-py, не asyncio)
# для Service Discovery через Pub/Sub
# ==============================================================================
REDIS_HOST=redis  # Используйте "redis" для Docker, "localhost" для внешнего доступа
REDIS_PORT=6379
REDIS_PASSWORD=  # ⚠️ НАСТРОИТЬ ДЛЯ PRODUCTION! Рекомендуется 32+ chars

# ==============================================================================
# CORS CONFIGURATION (Security Critical!)
# ==============================================================================
# ⚠️ ВАЖНО: Для production ОБЯЗАТЕЛЬНО настроить explicit origin whitelist!
# Wildcard origins ("*") ЗАПРЕЩЕНЫ в production для защиты от CSRF attacks.
#
# Development example:
CORS_ALLOW_ORIGINS=["http://localhost:4200","http://localhost:8000","http://localhost:3000"]
#
# Production example (замените на ваши реальные домены):
# CORS_ALLOW_ORIGINS=["https://artstore.example.com","https://admin.artstore.example.com"]

CORS_ALLOW_CREDENTIALS=true
CORS_ENABLED=true

# ==============================================================================
# MONITORING (Grafana)
# ==============================================================================
GF_SECURITY_ADMIN_PASSWORD=admin123  # ⚠️ ИЗМЕНИТЬ ДЛЯ PRODUCTION! Используйте strong random password

# ==============================================================================
# MINIO (S3-compatible Storage)
# ==============================================================================
MINIO_ROOT_USER=minioadmin  # ⚠️ ИЗМЕНИТЬ ДЛЯ PRODUCTION!
MINIO_ROOT_PASSWORD=minioadmin  # ⚠️ ИЗМЕНИТЬ ДЛЯ PRODUCTION! Используйте strong random password (32+ chars)

# MinIO Browser (опционально)
MINIO_BROWSER_URL=  # Например: https://minio.example.com

# ==============================================================================
# PGADMIN (PostgreSQL Management - Optional)
# ==============================================================================
PGADMIN_EMAIL=admin@admin.com
PGADMIN_PASSWORD=password  # ⚠️ ИЗМЕНИТЬ ДЛЯ PRODUCTION!

# ==============================================================================
# LOGGING
# ==============================================================================
LOG_LEVEL=INFO  # DEBUG | INFO | WARNING | ERROR | CRITICAL
LOG_FORMAT=json  # json (production, ОБЯЗАТЕЛЬНО!) | text (development only)

# ==============================================================================
# ADMIN MODULE CONFIGURATION
# ==============================================================================
# JWT Configuration (RS256 для distributed validation)
JWT_PRIVATE_KEY_PATH=/app/.keys/private_key.pem
JWT_PUBLIC_KEY_PATH=/app/.keys/public_key.pem
JWT_ALGORITHM=RS256
JWT_ACCESS_TOKEN_EXPIRE_MINUTES=30
JWT_REFRESH_TOKEN_EXPIRE_DAYS=7

# Initial Service Account (auto-created on first startup)
INITIAL_ACCOUNT_ENABLED=true
INITIAL_ACCOUNT_NAME=admin-service
INITIAL_CLIENT_ID=  # Оставить пустым для автогенерации UUID
INITIAL_CLIENT_SECRET=  # ⚠️ ОБЯЗАТЕЛЬНО УСТАНОВИТЬ ДЛЯ PRODUCTION! (32+ chars random)

# ==============================================================================
# STORAGE ELEMENT CONFIGURATION
# ==============================================================================
# Storage Element 01
STORAGE_01_MODE=edit  # edit | rw | ro | ar
STORAGE_01_TYPE=local  # local | s3
STORAGE_01_WORKERS=4  # Количество Uvicorn workers

# Storage Element 02 (опционально, --profile multi-storage)
STORAGE_02_MODE=rw  # edit | rw | ro | ar
STORAGE_02_TYPE=local  # local | s3
STORAGE_02_WORKERS=4

# Storage Limits
STORAGE_MAX_FILE_SIZE=1073741824  # 1GB в байтах

# S3 Configuration (если STORAGE_TYPE=s3)
STORAGE_S3_ENDPOINT=http://minio:9000
STORAGE_S3_BUCKET_PREFIX=artstore-storage-  # Будет: artstore-storage-01, artstore-storage-02, etc.
STORAGE_S3_REGION=us-east-1

# ==============================================================================
# DOCKER COMPOSE SPECIFIC
# ==============================================================================
# Используется только при запуске через docker-compose файлы

# Network Configuration
# SUBNET=172.28.0.0/16  # Custom subnet для artstore_network

# Resource Limits (раскомментируйте для ограничения ресурсов)
# POSTGRES_CPU_LIMIT=2.0
# POSTGRES_MEMORY_LIMIT=2G
# REDIS_CPU_LIMIT=1.0
# REDIS_MEMORY_LIMIT=1G

# ==============================================================================
# PRODUCTION SECURITY CHECKLIST
# ==============================================================================
# Перед production деплоем ОБЯЗАТЕЛЬНО:
#
# [ ] Установлен ENVIRONMENT=production
# [ ] Изменены ВСЕ пароли (DB, Redis, MinIO, PgAdmin, Grafana)
# [ ] Установлен INITIAL_CLIENT_SECRET (32+ chars random)
# [ ] Настроен CORS_ALLOW_ORIGINS (explicit domains, НЕ wildcard!)
# [ ] Установлен LOG_FORMAT=json
# [ ] Настроен REDIS_PASSWORD
# [ ] Изменен POSTGRES_AUTH_METHOD=md5
# [ ] Настроены TLS/SSL certificates (через reverse proxy)
# [ ] Настроены firewall rules
# [ ] Настроена backup стратегия для volumes
# [ ] Настроен monitoring и alerting
#
# ==============================================================================
# SECURITY NOTES
# ==============================================================================
# 1. CORS Origins: Настройте explicit whitelist для production
# 2. Passwords: Используйте cryptographically secure random passwords (32+ chars)
# 3. JWT Keys: Генерируются автоматически Admin Module при первом запуске
# 4. Secrets Management: Рассмотрите Docker Secrets или HashiCorp Vault для production
# 5. Environment: ВСЕГДА ENVIRONMENT=production для production деплоя
# 6. Redis: SYNC режим обязателен для Service Discovery (redis-py, не asyncio)
# 7. PostgreSQL: Async через asyncpg для всех модулей
# 8. Logging: JSON формат обязателен для production (интеграция с ELK/Splunk)
# ==============================================================================
