# Ответы на вопросы

1. Модель данных и атрибуты документов

Q: Какие конкретно атрибуты должны храниться в *.attr.json файлах? (имя, размер, mime-type, дата создания, владелец, версия, срок хранения - что еще?)

A: Метаданные содержат:

- Уникальный идентификатор файла.
- Имя файла
- Размер файла
- Время создания файла
- Пользователя, создавшего файл. Его логин, ФИО и UID.
- Краткая информация о содержимом файла (Пользовательское описание). Может быть пустым.
- Версия документа.

Q: Планируется ли поддержка пользовательских метаданных (custom metadata) для документов?

A: На начальном этапе нет. Но предполагается, что в новых версиях хранилища набор аотрибутов может быть расширен и должна быть возможность в остальных модулях это учитывать.

Q: Как должна работать версионность документов? (полное хранение каждой версии или delta/diff между версиями?)
A: Полное хранение.

Q: Каков максимальный размер файла атрибутов и как обеспечить его атомарную запись?

A: На данный момент не понятно.

2. Распределение файлов между Storage Elements

❓ Стратегия размещения:

Q: Какой алгоритм распределения файлов между несколькими Storage Elements в режиме EDIT? (round-robin, consistent hashing, weighted по свободному месту?)

A: Предполагается, что будет текущий Storage Element в который записываются файлы до его заполнения. После запись переходит на следцющий добавленный элемент.

Q: Как определяется, что Storage Element "заполнен" и нужен переход на следующий? (процент заполнения, абсолютный размер, количество файлов?)

A: Абсолютный размер. Если следующий файл, который необходимо пометстить в Storage Element не помещается. Он должен разимещаться в ледующм по очереди элменте.

Q: Должна ли система поддерживать репликацию файлов между Storage Elements для повышения отказоустойчивости?

A: Желательно такую возможность добавить. Но и предусмотреть работу элемента в единствненном экзкмпляре.

Q: Как обрабатывается ситуация, когда файл нужно загрузить, но все Storage Elements в режиме EDIT недоступны?

A: Сообщать об ошибке пользователю в ответе. администратору в метриках, логах, отображать в UI системы, отсылать по электронной почте или в мессенджеры. Последнее должно иметь возможность настройки.

3. Переходы между режимами Storage Element

❓ Процедуры перехода режимов:

Q: Каков точный процесс перехода RW → RO? (завершение текущих операций записи, валидация целостности, уведомление Service Discovery?)

A: Только по желанию администратора системы.

Q: Как гарантируется, что во время перехода RO → AR все файлы корректно перемещены на архивное хранилище?

A: Процесс запуска архивации делается сторонними приложениями. После окончания архивации администратор вручную переводит хранилище в режим AR в UI системы.

Q: Должна ли система блокировать доступ к Storage Element во время смены режима или поддерживать graceful transition?

A: Предпорлагается что переход в режим AR - это запрос к API StorageElement из адмиинистративного модуля.

Q: Что происходит с файлами в режиме AR при запросе? (error message, очередь на восстановление из архива, автоматическое восстановление через X часов?)

A: Пользователю возвращается сообщение о начале процесса восстановления файла из архива на специальный Storage Element в котором файлы восстановленные из архива находтся в течении определенног срока. Срок задается в настройках элемента. Как вариант возможно восстановление сторонним приложениями всего архивного элемента. Но не понятны проблемы с дисковым пространством если будут запрошены файлы с разных архивов. Предложи лучший вариант.

4. Saga Pattern и распределенные транзакции

A: Не знаю ответы на эти вопросы

5. Vector Clocks и разрешение конфликтов

A: Не знаю ответы на эти вопросы

6. Производительность и масштабирование

❓ Метрики и ограничения:

Q: Каковы ожидаемые SLA по производительности? (максимальная latency для upload/download, максимальное количество одновременных пользователей?)

A: Около 2000 пользователей. latency не нормируется (?).

Q: Каков ожидаемый объем хранимых данных? (сотни TB, PB?) и прогноз роста?

A: На данный момент до петабайта дисков. Хранилище архивов не ограничено.

Q: Какова максимальная допустимая задержка индексации файла после загрузки? (realtime, несколько секунд, минут?)

A: Индексация (опциональный функционал) файла может происходит параллельным процессом. Главное загрузить файл и указать базовые аттрибуты.

Q: Должна ли система поддерживать batch operations (массовая загрузка/удаление файлов)?

A: Обязательно.

7. Поиск и индексация

A: Опциональный фуекционал. Предполагается что индексация и поиск по содержимому только для элементов в не AR.

8. Безопасность и права доступа

Q: Какие роли пользователей предусмотрены в системе? (admin, user, auditor, readonly - другие?)

A: admin, user, auditor

Q: Должна ли система поддерживать ACL (Access Control Lists) на уровне отдельных файлов?

A: нет

Q: Как реализуется разграничение доступа к Storage Elements? (все пользователи видят все элементы или доступ ограничен?)

A: Доступ не ограничен. Он реализуется в приложениях использующих систему. Но важен аудит действий пользователей.

Q: Планируется ли интеграция с внешними системами аутентификации (LDAP, Active Directory, OAuth)?

A: Обязательно.

9. Мониторинг и алертинг

❓ Критические события:

Q: Какие события должны генерировать критические алерты для администраторов? (Storage Element заполнен на >90%, failover Admin Module Cluster, долгая Saga транзакция?)

A: Алертинг строится на базе внешних инструментов (Prometheus, AlertManager и т.п.) Для оторажения алертов в UI системы как опция должна быть возсможность подключения к Alert Manage. А для отображения графиков к Grafana.

Q: Должна ли система поддерживать предиктивные алерты (прогноз заполнения через N дней, прогноз истечения срока хранения документов?)

A: Как опция.

Q: Какие метрики критичны для SLA monitoring?

A: пока не известно

10. Восстановление после сбоев

❓ Disaster Recovery:

Q: Какова стратегия резервного копирования Storage Elements? (full backup + incremental, continuous replication?)

A: Элементы в режиме RO - full backup. RW и EDIT full backup + incremental. Процедуры проводятся сторонними приложениями для бакапа файловой системы.

Q: Как долго должны храниться резервные копии и как часто создаваться?

A: Решает оператор стороненей системы бекапа.

Q: Каков процесс восстановления Storage Element из backup? (автоматический, с подтверждением администратора?)

A:  подтверждением администратора

Q: Должна ли система поддерживать cross-datacenter replication для критичных данных?

A: на данный момент нет.

11. Предлагаемые направления обсуждения

Ни один из вопросов сейчас не актуален для меня.