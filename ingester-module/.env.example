# ==========================================
# ArtStore Ingester Module - Configuration
# ==========================================

# ==========================================
# Application Settings
# ==========================================
APP_NAME=artstore-ingester
APP_VERSION=0.1.0
APP_DEBUG=off
APP_HOST=0.0.0.0
APP_PORT=8020

# ==========================================
# Authentication Settings
# ==========================================
# JWT токен валидация (RS256 public key)
AUTH_ENABLED=on
AUTH_PUBLIC_KEY_PATH=/app/keys/public_key.pem
AUTH_ALGORITHM=RS256
# Sprint 16: Admin Module URL для health checks и Service Discovery fallback
AUTH_ADMIN_MODULE_URL=http://admin-module:8000

# ==========================================
# Storage Element HTTP Client Settings
# ==========================================
# Sprint 16: STORAGE_ELEMENT_BASE_URL УДАЛЁН
# Endpoints выбираются динамически через Service Discovery:
# - Primary: Redis Service Discovery
# - Fallback: Admin Module API
# Эти настройки применяются к HTTP клиентам для всех SE endpoints
STORAGE_ELEMENT_TIMEOUT=30
STORAGE_ELEMENT_MAX_RETRIES=3
STORAGE_ELEMENT_CONNECTION_POOL_SIZE=100

# ==========================================
# Redis (async режим, DB=0 для Ingester Module)
# ==========================================
# Используется для: Service Discovery, координация загрузок
# Альтернатива: REDIS_URL=redis://[:password@]host:port/db
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_DB=0
REDIS_PASSWORD=
REDIS_MAX_CONNECTIONS=50

# ==========================================
# AdaptiveCapacityMonitor Settings
# ==========================================
# Sprint 21: Периодическое обновление SE конфигурации
# Два механизма reload:
# 1. Periodic Reload: Background task читает из Redis/Admin Module каждые N секунд
# 2. Lazy Reload: Немедленное обновление при ошибках (507, 404, connection errors)

# Включить периодическое обновление SE конфигурации (on/off)
CAPACITY_MONITOR_CONFIG_RELOAD_ENABLED=on

# Интервал обновления в секундах (диапазон: 10-600)
# Рекомендуемые значения:
# - 60s (1 минута) - production default, баланс актуальности и нагрузки
# - 30s - для high-availability сценариев с частыми SE changes
# - 120s (2 минуты) - для стабильных окружений с редкими изменениями
CAPACITY_MONITOR_CONFIG_RELOAD_INTERVAL=60

# ==========================================
# Compression Settings
# ==========================================
# Опции сжатия файлов перед загрузкой
COMPRESSION_ENABLED=on
COMPRESSION_ALGORITHM=gzip  # gzip или brotli
COMPRESSION_LEVEL=6  # 1-9 для gzip, 0-11 для brotli
COMPRESSION_MIN_SIZE=1024  # Минимальный размер файла для сжатия (bytes)

# ==========================================
# Logging Settings
# ==========================================
# Уровень логирования: DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_LEVEL=INFO
# Формат логов: json (production) или text (development)
LOG_FORMAT=json
# Путь к файлу логов (оставьте пустым для stdout)
LOG_FILE=

# ==========================================
# Performance Settings (Future)
# ==========================================
# Circuit Breaker настройки (TODO)
# CIRCUIT_BREAKER_THRESHOLD=5
# CIRCUIT_BREAKER_TIMEOUT=60
# CIRCUIT_BREAKER_HALF_OPEN_TIMEOUT=30

# Saga координация (TODO)
# SAGA_TIMEOUT=300
# SAGA_RETRY_ATTEMPTS=3

# Streaming upload (TODO)
# STREAMING_CHUNK_SIZE=1048576  # 1MB chunks
# STREAMING_BUFFER_SIZE=10485760  # 10MB buffer
